# 接口设计

## 1. 用户模块

### 1.1 用户注册
```http
POST /api/users/register
Content-Type: application/json

{
  "username": "string",
  "email": "string",
  "password": "string",
  "captcha": "string"
}
```

```
{
  "code": 200,
  "message": "注册成功",
  "data": {
    "id": 123,
    "username": "testuser",
    "email": "test@example.com",
    "nickname": "测试用户",
    "avatarUrl": null,
    "createTime": "2024-01-15T10:30:00Z"
  },
  "timestamp": "2024-01-15T10:30:00Z"
}
```

### 1.2 用户登录

```http
POST /api/users/login
Content-Type: application/json

{
  "username": "string",
  "password": "string"
}
```

```
{
  "code": 200,
  "message": "登录成功",
  "data": {
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "user": {
      "id": 123,
      "username": "testuser",
      "email": "test@example.com",
      "nickname": "测试用户",
      "avatarUrl": "https://example.com/avatar.jpg",
      "bio": "个人简介",
      "role": 0,
      "followerCount": 0,
      "lastLoginTime": "2024-01-15T10:30:00Z"
    }
  },
  "timestamp": "2024-01-15T10:30:00Z"
}
```

### 1.3 获取用户信息

```http
GET /api/users/{userId}
Authorization: Bearer {token}
```

```
{
  "code": 200,
  "message": "成功",
  "data": {
    "id": 123,
    "username": "testuser",
    "email": "test@example.com",
    "phone": "13800138000",
    "nickname": "测试用户",
    "bio": "这是一个个人简介",
    "avatarUrl": "https://example.com/avatar.jpg",
    "createTime": "2024-01-01T00:00:00Z",
    "lastLoginTime": "2024-01-15T10:30:00Z",
    "status": 0,
    "role": 0,
    "followerCount": 150,
    "followingCount": 85,
    "articleCount": 42,
    "isFollowing": false
  },
  "timestamp": "2024-01-15T10:30:00Z"
}
```

### 1.4 更新用户信息

```http
PUT /api/users/{userId}
Authorization: Bearer {token}
Content-Type: application/json

{
  "nickname": "string",
  "bio": "string",
  "avatarUrl": "string"
}
```

```
{
  "code": 200,
  "message": "更新成功",
  "data": {
    "id": 123,
    "nickname": "新昵称",
    "bio": "新的个人简介",
    "avatarUrl": "https://example.com/new-avatar.jpg"
  },
  "timestamp": "2024-01-15T10:30:00Z"
}
```

### 1.5 获取用户列表（管理员）

```http
GET /api/users?page=1&size=20&status=0&role=0
Authorization: Bearer {token}
```

```
{
  "code": 200,
  "message": "成功",
  "data": {
    "list": [
      {
        "id": 123,
        "username": "user1",
        "nickname": "用户1",
        "avatarUrl": "https://example.com/avatar1.jpg",
        "bio": "简介1",
        "followerCount": 100,
        "articleCount": 25,
        "createTime": "2024-01-01T00:00:00Z",
        "status": 0
      }
    ],
    "total": 150,
    "page": 1,
    "size": 20,
    "totalPages": 8
  },
  "timestamp": "2024-01-15T10:30:00Z"
}
```



## 2. 文章模块

### 2.1 创建文章
```http
POST /api/articles
Authorization: Bearer {token}
Content-Type: application/json

{
  "title": "string",
  "content": "string",
  "circleId": 0,
  "tagIds": [1, 2, 3],
  "status": 0
}
```

```
{
  "code": 200,
  "message": "文章创建成功",
  "data": {
    "id": 456,
    "title": "文章标题",
    "content": "文章内容",
    "status": 0,
    "createTime": "2024-01-15T10:30:00Z",
    "authorId": 123
  },
  "timestamp": "2024-01-15T10:30:00Z"
}
```

### 2.2 获取文章详情

```http
GET /api/articles/{articleId}
```

```
{
  "code": 200,
  "message": "成功",
  "data": {
    "id": 456,
    "title": "文章标题",
    "content": "文章内容...",
    "createTime": "2024-01-15T10:30:00Z",
    "updateTime": "2024-01-15T11:30:00Z",
    "publishTime": "2024-01-15T10:30:00Z",
    "status": 1,
    "viewCount": 1500,
    "likeCount": 120,
    "starCount": 45,
    "commentCount": 23,
    "author": {
      "id": 123,
      "username": "authoruser",
      "nickname": "作者昵称",
      "avatarUrl": "https://example.com/author-avatar.jpg"
    },
    "circle": {
      "id": 789,
      "name": "技术圈",
      "description": "技术交流圈子"
    },
    "tags": [
      {
        "id": 1,
        "name": "Java"
      },
      {
        "id": 2,
        "name": "Spring"
      }
    ],
    "isLiked": true,
    "isStarred": false
  },
  "timestamp": "2024-01-15T10:30:00Z"
}
```

### 2.3 更新文章

```http
PUT /api/articles/{articleId}
Authorization: Bearer {token}
Content-Type: application/json

{
  "title": "string",
  "content": "string",
  "circleId": 0,
  "tagIds": [1, 2, 3],
  "status": 0
}
```

```
{
  "code": 200,
  "message": "文章更新成功",
  "data": {
    "id": 456,
    "title": "更新后的标题",
    "content": "更新后的内容",
    "updateTime": "2024-01-15T11:30:00Z"
  },
  "timestamp": "2024-01-15T11:30:00Z"
}
```

### 2.4 删除文章

```http
DELETE /api/articles/{articleId}
Authorization: Bearer {token}
```

```
{
  "code": 200,
  "message": "文章删除成功",
  "data": null,
  "timestamp": "2024-01-15T10:30:00Z"
}
```

### 2.5 获取文章列表

```http
GET /api/articles?page=1&size=20&authorId=1&circleId=1&tagId=1&status=1&keyword=search
```

```
{
  "code": 200,
  "message": "成功",
  "data": {
    "list": [
      {
        "id": 456,
        "title": "文章标题",
        "summary": "文章摘要...",
        "createTime": "2024-01-15T10:30:00Z",
        "publishTime": "2024-01-15T10:30:00Z",
        "viewCount": 1500,
        "likeCount": 120,
        "starCount": 45,
        "commentCount": 23,
        "author": {
          "id": 123,
          "nickname": "作者昵称",
          "avatarUrl": "https://example.com/avatar.jpg"
        },
        "circle": {
          "id": 789,
          "name": "技术圈"
        },
        "tags": [
          {"id": 1, "name": "Java"},
          {"id": 2, "name": "Spring"}
        ]
      }
    ],
    "total": 150,
    "page": 1,
    "size": 20,
    "totalPages": 8
  },
  "timestamp": "2024-01-15T10:30:00Z"
}
```

### 2.6 获取用户文章列表

```http
GET /api/users/{userId}/articles?page=1&size=20&status=1
```



## 3. 标签模块

### 3.1 创建标签
```http
POST /api/tags
Authorization: Bearer {token}
Content-Type: application/json

{
  "name": "string"
}
```

```
{
  "code": 200,
  "message": "标签创建成功",
  "data": {
    "id": 10,
    "name": "新标签",
    "articleCount": 0
  },
  "timestamp": "2024-01-15T10:30:00Z"
}
```

### 3.2 获取标签列表

```http
GET /api/tags?page=1&size=50&keyword=search
```

```
{
  "code": 200,
  "message": "成功",
  "data": {
    "list": [
      {
        "id": 1,
        "name": "Java",
        "articleCount": 150
      },
      {
        "id": 2,
        "name": "Spring",
        "articleCount": 89
      }
    ],
    "total": 50,
    "page": 1,
    "size": 20,
    "totalPages": 3
  },
  "timestamp": "2024-01-15T10:30:00Z"
}
```

### 3.3 获取热门标签

```http
GET /api/tags/popular?limit=20
```

```
{
  "code": 200,
  "message": "成功",
  "data": [
    {
      "id": 1,
      "name": "Java",
      "articleCount": 150
    },
    {
      "id": 2,
      "name": "Spring",
      "articleCount": 89
    },
    {
      "id": 3,
      "name": "MySQL",
      "articleCount": 76
    }
  ],
  "timestamp": "2024-01-15T10:30:00Z"
}
```



## 4. 评论模块

### 4.1 发表评论
```http
POST /api/comments
Authorization: Bearer {token}
Content-Type: application/json

{
  "content": "string",
  "articleId": 0
}
```

```
{
  "code": 200,
  "message": "评论成功",
  "data": {
    "id": 999,
    "content": "评论内容",
    "createTime": "2024-01-15T10:30:00Z",
    "likeCount": 0,
    "user": {
      "id": 123,
      "nickname": "用户昵称",
      "avatarUrl": "https://example.com/avatar.jpg"
    },
    "articleId": 456
  },
  "timestamp": "2024-01-15T10:30:00Z"
}
```

### 4.2 获取文章评论

```http
GET /api/articles/{articleId}/comments?page=1&size=20
```

```
{
  "code": 200,
  "message": "成功",
  "data": {
    "list": [
      {
        "id": 999,
        "content": "评论内容",
        "createTime": "2024-01-15T10:30:00Z",
        "likeCount": 5,
        "user": {
          "id": 123,
          "nickname": "用户昵称",
          "avatarUrl": "https://example.com/avatar.jpg"
        },
        "isLiked": false
      }
    ],
    "total": 23,
    "page": 1,
    "size": 20,
    "totalPages": 2
  },
  "timestamp": "2024-01-15T10:30:00Z"
}
```

### 4.3 删除评论

```http
DELETE /api/comments/{commentId}
Authorization: Bearer {token}
```



## 5. 圈子模块

### 5.1 创建圈子
```http
POST /api/circles
Authorization: Bearer {token}
Content-Type: application/json

{
  "name": "string",
  "description": "string",
  "creatorId": 0
}
```

```
{
  "code": 200,
  "message": "圈子创建成功",
  "data": {
    "id": 789,
    "name": "圈子名称",
    "description": "圈子描述",
    "creatorId": 123,
    "createTime": "2024-01-15T10:30:00Z",
    "memberCount": 1
  },
  "timestamp": "2024-01-15T10:30:00Z"
}
```

### 5.2 获取圈子列表

```http
GET /api/circles?page=1&size=20&keyword=search
```

```
{
  "code": 200,
  "message": "成功",
  "data": {
    "list": [
      {
        "id": 789,
        "name": "技术圈",
        "description": "技术交流圈子",
        "creator": {
          "id": 123,
          "nickname": "创建者昵称"
        },
        "createTime": "2024-01-01T00:00:00Z",
        "memberCount": 150,
        "articleCount": 450,
        "isMember": true,
        "memberRole": 0
      }
    ],
    "total": 25,
    "page": 1,
    "size": 20,
    "totalPages": 2
  },
  "timestamp": "2024-01-15T10:30:00Z"
}
```

### 5.3 获取圈子详情

```http
GET /api/circles/{circleId}
```

```
{
  "code": 200,
  "message": "成功",
  "data": {
    "id": 789,
    "name": "技术圈",
    "description": "技术交流圈子描述...",
    "creator": {
      "id": 123,
      "nickname": "创建者昵称",
      "avatarUrl": "https://example.com/avatar.jpg"
    },
    "createTime": "2024-01-01T00:00:00Z",
    "memberCount": 150,
    "articleCount": 450,
    "isMember": true,
    "memberRole": 0,
    "joinTime": "2024-01-10T10:30:00Z"
  },
  "timestamp": "2024-01-15T10:30:00Z"
}
```

### 5.4 加入圈子

```http
POST /api/circles/{circleId}/join
Authorization: Bearer {token}
```

```
{
  "code": 200,
  "message": "成功加入圈子",
  "data": {
    "circleId": 789,
    "userId": 123,
    "joinTime": "2024-01-15T10:30:00Z",
    "role": 0
  },
  "timestamp": "2024-01-15T10:30:00Z"
}
```

### 5.5 退出圈子

```http
DELETE /api/circles/{circleId}/exit
Authorization: Bearer {token}
```

### 5.6 获取圈子成员
```http
GET /api/circles/{circleId}/members?page=1&size=20
```



## 6. 互动功能模块

### 6.1 点赞文章
```http
POST /api/articles/{articleId}/like
Authorization: Bearer {token}
```

```
{
  "code": 200,
  "message": "操作成功",
  "data": {
    "articleId": 456,
    "likeCount": 121,
    "isLiked": true
  },
  "timestamp": "2024-01-15T10:30:00Z"
}
```

### 6.2 取消点赞文章

```http
DELETE /api/articles/{articleId}/like
Authorization: Bearer {token}
```

```
{
  "code": 200,
  "message": "操作成功",
  "data": {
    "articleId": 456,
    "likeCount": 121,
    "isLiked": true
  },
  "timestamp": "2024-01-15T10:30:00Z"
}
```

### 6.3 收藏文章

```http
POST /api/articles/{articleId}/star
Authorization: Bearer {token}
```

```
{
  "code": 200,
  "message": "操作成功",
  "data": {
    "articleId": 456,
    "starCount": 46,
    "isStarred": true
  },
  "timestamp": "2024-01-15T10:30:00Z"
}
```

### 6.4 取消收藏文章

```http
DELETE /api/articles/{articleId}/star
Authorization: Bearer {token}
```

```
{
  "code": 200,
  "message": "操作成功",
  "data": {
    "articleId": 456,
    "starCount": 46,
    "isStarred": true
  },
  "timestamp": "2024-01-15T10:30:00Z"
}
```

### 6.5 点赞评论

```http
POST /api/comments/{commentId}/like
Authorization: Bearer {token}
```

```
{
  "code": 200,
  "message": "操作成功",
  "data": {
    "articleId": 456,
    "starCount": 46,
    "isStarred": true
  },
  "timestamp": "2024-01-15T10:30:00Z"
}
```

### 6.6 取消点赞评论

```http
DELETE /api/comments/{commentId}/like
Authorization: Bearer {token}
```

```
{
  "code": 200,
  "message": "操作成功",
  "data": {
    "articleId": 456,
    "starCount": 46,
    "isStarred": true
  },
  "timestamp": "2024-01-15T10:30:00Z"
}
```

### 6.7 关注用户

```http
POST /api/users/{userId}/follow
Authorization: Bearer {token}
```

```
{
  "code": 200,
  "message": "操作成功",
  "data": {
    "targetUserId": 123,
    "isFollowing": true,
    "followerCount": 151
  },
  "timestamp": "2024-01-15T10:30:00Z"
}
```

### 6.8 取消关注用户

```http
DELETE /api/users/{userId}/follow
Authorization: Bearer {token}
```

```
{
  "code": 200,
  "message": "操作成功",
  "data": {
    "targetUserId": 123,
    "isFollowing": true,
    "followerCount": 151
  },
  "timestamp": "2024-01-15T10:30:00Z"
}
```



## 7. 数据统计模块（TODO）

### 7.1 获取用户统计数据
```http
GET /api/users/{userId}/stats
```

```
{
  "code": 200,
  "message": "成功",
  "data": {
    "userId": 123,
    "articleCount": 42,
    "totalViews": 15000,
    "totalLikes": 850,
    "totalStars": 320,
    "followerCount": 150,
    "followingCount": 85,
    "circleCount": 5
  },
  "timestamp": "2024-01-15T10:30:00Z"
}
```

### 7.2 获取文章统计数据

```http
GET /api/articles/{articleId}/stats
```

### 7.3 获取热门文章
```http
GET /api/articles/popular?period=week&limit=10
```

```
{
  "code": 200,
  "message": "成功",
  "data": [
    {
      "id": 456,
      "title": "热门文章标题",
      "author": {
        "id": 123,
        "nickname": "作者昵称"
      },
      "viewCount": 5000,
      "likeCount": 300,
      "commentCount": 45,
      "publishTime": "2024-01-14T10:30:00Z"
    }
  ],
  "timestamp": "2024-01-15T10:30:00Z"
}
```



## 8. 说明

响应格式：

```typescript
interface ApiResponse<T> {
  code: number;
  message: string;
  data: T;
  timestamp: string;
}

interface PaginatedResponse<T> {
  list: T[];
  total: number;
  page: number;
  size: number;
  totalPages: number;
}
```

权限：

- **公开接口**：无需认证（用户注册、登录、获取文章列表、文章详情等）
- **用户接口**：需要用户登录（发表评论、点赞、关注等）
- **管理员接口**：需要管理员权限（用户管理、内容审核等）
